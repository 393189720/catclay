# 阿里ECS安装node、mongoDB

------

本文主要介绍阿里云ECS服务器，CentOS 7.0系统安装node运行环境、mongoDB数据库、nginx服务器：

> * 相关知识介绍
> * 安装node环境
> * 安装mongoDB
> * 安装nginx
> * 安装mysql


### [相关知识介绍]

> 请保留此份 Cmd Markdown 的欢迎稿兼使用说明，如需撰写新稿件，点击顶部工具栏右侧的 <i class="icon-file"></i> **新文稿** 或者使用快捷键 `Ctrl+Alt+N`。

------

## 安装Node环境

[Node官方地址](https://nodejs.org/en/download/)。
###1.下载node源码
使用wget命令下载：

    # 进入src目录
    cd /usr/local/src/
    mkdir nodejs
    cd nodejs
    wget https://nodejs.org/dist/v6.9.1/node-v6.9.1.tar.gz
更多wget命令，[参考博文](http://www.cnblogs.com/peida/archive/2013/03/18/2965369.html)
###2.编译安装node

    #解压安装包
    tar xvf node-v4.2.2.tar.gz
    #进度node文件夹
    cd node-v6.9.1
    ./configure
    make
    make install
    cp /usr/local/bin/node /usr/sbin
    #查看node版本
    node -v

 - configure命令做了大量的“幕后”工作，包括检测操作系统内核和已经安装的软件，参数的解析，中间目录的生成以及根据各种参数生成一些C源码文件、Makefile文件等。
 - make命令根据configure命令生成的Makefile文件编译工程，并生成目标文件、最终的二进制文件。
 - make install命令根据configure执行时的参数将部署到指定的安装目录，包括相关目录的建立和二进制文件、配置文件的复制。
 
到此整个安装已经完成，如果在安装过程有错误问题，请参考以下解决：
 
 - The program 'make' is currently not installed. You can install it by typing: apt-get install make 按照它的提示，使用命令 apt-get install make


 - g++: Command not found 没有安装过g++，现在执行安装 apt-get install g++

Node.js安装成功！

 
## 安装mongoDB

[mongoDB官方地址](https://www.mongodb.com/)。
### 资源
[阿里云mongodb安装的启动](http://www.tuicool.com/articles/rIj6byM)
[centos mongodb](http://www.tuicool.com/articles/JbAVvu)
[官方:centos or redhat 安装和使用mongodb](https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/)
### 环境
系统：centos 7 64位
mongodb： 3.2版本
方式： yum
### 过程
推荐参考资源的官方文档，当然如果你是centos6的，也可以看看其他文章，笔者用的是7，mongodb想用3以上的版本，加上阿里云推荐使用yum进行下包（速度支持快很多），于是便看着官方文档上来
### 修改yum的包管理系统

    vim /etc/yum.repos.d/mongodb-org-3.2.repo
### 填写配置信息：

    [mongodb-org-3.2]
    name=MongoDB Repository
    baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/x86_64/
    gpgcheck=1
    enabled=1
    gpgkey=https://www.mongodb.org/static/pgp/server-3.2.asc
### 安装mongodb

    yum install -y mongodb-org
### 使用mongodb

    #启动
    service mongod start
    #停止
    service mongod stop
    #重启
    service mongod restart
    #客户端
    mongo
至此，配置就完成了，就可以在你的项目里面像本地一样使用数据库服务了。

## 安装nginx
1、安装nginx

    yum -y install nginx

2、启动nginx

    service nginx start

3、访问（nginx默认是80端口）

    curl 127.0.0.1

4、域名子绑定

    编辑文件/etc/nginx/conf.d/default.conf，在底部加入下面代码，完成前几章所述4个端口的子域名绑定
```python
server{
        listen    80;
        server_name    tomcat.catclay.com;
            location /
            {
                proxy_set_header Host $host;
                proxy_set_header X-Real-Ip $remote_addr;
                proxy_set_header X-Forwarded-For $remote_addr;
                proxy_pass http://127.0.0.1:14802;
            }
}
 
server{
        listen    80;
        server_name    jetty.catclay.com;
            location /
            {
                proxy_set_header Host $host;
                proxy_set_header X-Real-Ip $remote_addr;
                proxy_set_header X-Forwarded-For $remote_addr;
                proxy_pass http://127.0.0.1:14808;
            }
}
 
server{
        listen    80;
        server_name    resin8080.catclay.com;
            location /
            {
                proxy_set_header Host $host;
                proxy_set_header X-Real-Ip $remote_addr;
                proxy_set_header X-Forwarded-For $remote_addr;
                proxy_pass http://127.0.0.1:8080;
            }
}
 
server{
        listen    80;
        server_name    resin14805.catclay.com;
            location /
            {
                proxy_set_header Host $host;
                proxy_set_header X-Real-Ip $remote_addr;
                proxy_set_header X-Forwarded-For $remote_addr;
                proxy_pass http://127.0.0.1:14805;
            }
}
```
5、重启nginx

    service nginx restart

6、访问测试

    依次访问上面4个域名：tomcat.bingzhenmifan.com、jetty.bingzhenmifan.com、resin8080.bingzhenmifan.com、resin14805.bingzhenmifan.com

    注意：如果域名没有备案的话，在本地是打不开网站的，可以在云服务器上使用curl命令访问

7、域名备案

    登录阿里云，点击右上角【备案】，按步骤完成备案即可

## 安装mysql
1、执行yum安装mysql命令：yum -y install mysql-server mysql-devel

2、启动mysql：service mysqld start

3、创建管理员：mysqladmin -u root password abc,123

4、连接测试：mysql -u root -p

5、show databases; 看看默认的库有哪些

6、新建一个库，并进入新建的库：create database llj;  use llj;

7、新建一个表：create table llj_mf_test(id int primary key, user_name varchar(20));  查看所有表：show tables;

8、新建一个用户：create user 'admin'@'%' identified by '123456';（%符号表示可以从任意远程主机登录）

9、授权：grant all on *.* to admin;

10、退出root登录，用新建的用户登录

11、打完收工